<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Color Match</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Georgia,serif;background:linear-gradient(135deg,#0a0e27,#1a1034,#2d1b4e);min-height:100vh;color:#e8e8f0;display:flex;flex-direction:column;align-items:center;padding:8px}
.title{font-size:1.4em;background:linear-gradient(135deg,#ffd700,#ff8c00);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.subtitle{color:#d4af37;margin-bottom:6px;font-size:0.8em}
.box{background:rgba(255,255,255,0.05);border:2px solid rgba(212,175,55,0.5);border-radius:12px;padding:10px;width:calc(100% - 16px);max-width:340px}
.hidden{display:none!important}
.banner{background:rgba(255,215,0,0.2);border:1px solid rgba(255,215,0,0.5);color:#ffd700;padding:4px 8px;border-radius:8px;font-size:0.7em}
.back{padding:4px 8px;background:rgba(255,255,255,0.1);border:1px solid rgba(212,175,55,0.3);border-radius:8px;color:#ffd700;text-decoration:none;font-size:0.7em}
.top-bar{width:calc(100% - 16px);max-width:340px;display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.popup-bg{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);display:flex;justify-content:center;align-items:center;z-index:5000}
.popup{background:linear-gradient(135deg,#1a1034,#2d1b4e);border:2px solid rgba(255,215,0,0.3);border-radius:12px;padding:16px;width:90%;max-width:260px;text-align:center}
.popup h3{color:#e8e8f0;margin-bottom:4px}
.popup p{color:#a0a0b8;font-size:0.75em;margin-bottom:12px}
.popup a{display:block;padding:8px;background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.2);border-radius:6px;color:#e8e8f0;text-decoration:none;margin-bottom:10px}
.popup button{width:100%;background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a1034;border:none;padding:8px;border-radius:12px;font-weight:bold;cursor:pointer}
.pin-title{color:#ffd700;font-size:1em;text-align:center;margin-bottom:4px}
.pin-sub{color:#b8b8cc;text-align:center;margin-bottom:12px;font-size:0.75em}
.dots{display:flex;justify-content:center;gap:8px;margin-bottom:12px}
.dot{width:12px;height:12px;border-radius:50%;border:2px solid rgba(212,175,55,0.5)}
.dot.on{background:#ffd700;border-color:#ffd700}
.keypad{display:grid;grid-template-columns:repeat(3,1fr);gap:5px;max-width:180px;margin:0 auto 10px}
.key{aspect-ratio:1;font-size:1.1em;border:2px solid rgba(212,175,55,0.3);background:rgba(255,255,255,0.05);color:#e8e8f0;border-radius:6px;cursor:pointer}
.key.empty{visibility:hidden}
.msg{text-align:center;min-height:16px;font-size:0.75em}
.msg.err{color:#ff6b6b}.msg.ok{color:#4ecdc4}
.toggle{text-align:center;margin-top:10px;color:#b8b8cc;font-size:0.75em}
.toggle span{color:#ffd700;cursor:pointer;text-decoration:underline}
.btn{width:100%;background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a1034;border:none;padding:10px;border-radius:15px;font-size:0.85em;font-weight:bold;cursor:pointer;margin-top:5px}
.btn2{background:linear-gradient(135deg,#8a2be2,#4b0082);color:#fff}
.welcome{background:rgba(255,215,0,0.1);border:1px solid rgba(255,215,0,0.3);border-radius:8px;padding:10px;margin-bottom:10px;text-align:center}
.welcome h3{color:#ffd700;margin-bottom:2px}
.welcome p{font-size:0.75em;color:#b8b8cc}
.stats{display:grid;grid-template-columns:repeat(2,1fr);gap:6px;margin:10px 0}
.stat{background:rgba(255,255,255,0.05);padding:8px;border-radius:6px;text-align:center;border:1px solid rgba(212,175,55,0.2)}
.stat b{display:block;font-size:1.2em;color:#ffd700}
.stat span{color:#b8b8cc;font-size:0.65em}
.game-info{display:flex;justify-content:space-between;margin-bottom:8px}
.game-stat{text-align:center}
.game-stat b{display:block;font-size:1.1em;color:#ffd700}
.game-stat span{color:#b8b8cc;font-size:0.65em}
.color-display{background:rgba(0,0,0,0.3);border-radius:12px;padding:20px;margin:10px 0;text-align:center}
.color-word{font-size:2.5em;font-weight:bold;margin-bottom:15px;text-transform:uppercase}
.color-instruction{color:#b8b8cc;font-size:0.8em;margin-bottom:15px}
.color-buttons{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
.color-btn{padding:15px;border-radius:10px;border:3px solid rgba(255,255,255,0.3);font-size:1em;font-weight:bold;cursor:pointer;text-transform:uppercase;color:#fff;text-shadow:1px 1px 2px rgba(0,0,0,0.5)}
.color-btn:active{transform:scale(0.95)}
.feedback{text-align:center;font-size:1.2em;margin:10px 0;min-height:30px}
.feedback.correct{color:#2ecc71}
.feedback.wrong{color:#e74c3c}
.timer-bar{height:8px;background:rgba(255,255,255,0.1);border-radius:4px;margin:10px 0;overflow:hidden}
.timer-fill{height:100%;background:linear-gradient(90deg,#e74c3c,#f39c12,#2ecc71);transition:width 0.1s linear}
.res-bg{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.9);display:flex;justify-content:center;align-items:center;z-index:3000}
.res{background:linear-gradient(135deg,#1a1034,#2d1b4e);border:2px solid #ffd700;border-radius:12px;padding:16px;width:90%;max-width:300px;text-align:center}
.res h2{color:#ffd700;margin-bottom:6px}
.res-score{font-size:2.5em;color:#ffd700;font-weight:bold}
.res-label{color:#b8b8cc;margin-bottom:10px}
.res-details{display:flex;justify-content:space-around;margin:10px 0}
.res-detail b{display:block;color:#ffd700;font-size:1.2em}
.res-detail span{color:#b8b8cc;font-size:0.7em}
.record{background:rgba(255,215,0,0.2);border:1px solid #ffd700;border-radius:5px;padding:6px;margin:8px 0;color:#ffd700;font-weight:bold}
.rating{color:#d4af37;margin-bottom:10px}
.name-input{width:100%;padding:10px;background:rgba(255,255,255,0.1);border:2px solid rgba(212,175,55,0.5);border-radius:8px;color:#e8e8f0;font-size:1em;margin-bottom:10px;text-align:center}
.name-input:focus{outline:none;border-color:#ffd700}
</style>
</head>
<body>
<div class="top-bar"><a href="https://hooporiapr-oss.github.io/akashic-works/" class="back">Home</a><div class="banner" id="bannerEl">3 free</div></div>
<div class="title">Color Match</div>
<div class="subtitle">Brain Training</div>
<div class="box" id="loginBox"><div class="pin-title">Enter PIN</div><div class="pin-sub">Enter your 4-digit PIN</div><div class="dots"><div class="dot" id="d1"></div><div class="dot" id="d2"></div><div class="dot" id="d3"></div><div class="dot" id="d4"></div></div><div class="keypad" id="loginPad"></div><div class="msg" id="loginMsg"></div><div class="toggle">No account? <span id="toCreate">Create PIN</span></div></div>
<div class="box hidden" id="createBox"><div class="pin-title" id="createTitle">Create PIN</div><div class="pin-sub" id="createSub">Choose a 4-digit PIN</div><div class="dots"><div class="dot" id="c1"></div><div class="dot" id="c2"></div><div class="dot" id="c3"></div><div class="dot" id="c4"></div></div><div class="keypad" id="createPad"></div><div class="msg" id="createMsg"></div><div class="toggle">Have a PIN? <span id="toLogin">Login</span></div></div>
<div class="box hidden" id="nameBox"><div class="pin-title">Set Display Name</div><div class="pin-sub">Choose a name for the leaderboard</div><input type="text" class="name-input" id="nameInput" placeholder="Enter your name" maxlength="15"><button class="btn" id="saveNameBtn">Save Name</button><div class="msg" id="nameMsg"></div></div>
<div class="box hidden" id="dashBox"><div class="welcome"><h3 id="welcomeName">Welcome!</h3><p>Match the ink color, not the word!</p></div><div class="stats"><div class="stat"><b id="dGames">0</b><span>Games</span></div><div class="stat"><b id="dBest">--</b><span>Best Score</span></div><div class="stat"><b id="dAvg">--</b><span>Average</span></div><div class="stat"><b id="dRate">--</b><span>Rating</span></div></div><button class="btn" id="startBtn">Start Game</button><button class="btn btn2" id="logoutBtn">Logout</button></div>
<div class="box hidden" id="gameBox"><div class="game-info"><div class="game-stat"><b id="gScore">0</b><span>Score</span></div><div class="game-stat"><b id="gRound">1/20</b><span>Round</span></div><div class="game-stat"><b id="gStreak">0</b><span>Streak</span></div></div><div class="timer-bar"><div class="timer-fill" id="timerFill" style="width:100%"></div></div><div class="color-display"><div class="color-instruction">Tap the COLOR of the ink, not the word!</div><div class="color-word" id="colorWord">RED</div><div class="feedback" id="feedback"></div><div class="color-buttons" id="colorBtns"></div></div><button class="btn btn2" id="quitBtn">Quit</button></div>
<div class="res-bg hidden" id="resBg"><div class="res"><h2>Results</h2><div class="res-score" id="resScore">0</div><div class="res-label">Points</div><div class="res-details"><div class="res-detail"><b id="resCorrect">0</b><span>Correct</span></div><div class="res-detail"><b id="resStreak">0</b><span>Best Streak</span></div></div><div class="record hidden" id="resRecord">New Record!</div><div class="rating" id="resRating">Rating: --</div><button class="btn" id="againBtn">Play Again</button><button class="btn btn2" id="menuBtn">Menu</button></div></div>
<div class="popup-bg hidden" id="limitPopup"><div class="popup"><h3 id="limitTitle">Daily limit reached</h3><p id="limitMsg">You used your 3 free games today</p><a href="https://hooporiapr-oss.github.io/akashic-works/">Return Home</a><button id="upgradeBtn">Unlock Unlimited</button></div></div>
<script>
(function(){
var PK="ak_pins",UK="ak_users",SK="cmen2_stats_",DK="ak_dev",MAX_DAILY=3,MAX_DAYS=3,ROUNDS=20,ROUND_TIME=3000;
var colors=[{name:"RED",hex:"#e74c3c"},{name:"BLUE",hex:"#3498db"},{name:"GREEN",hex:"#2ecc71"},{name:"YELLOW",hex:"#f1c40f"},{name:"PURPLE",hex:"#9b59b6"},{name:"ORANGE",hex:"#e67e22"}];
var currentPin="",currentUser=null,score=0,round=0,correct=0,streak=0,bestStreak=0,currentAnswer="",timerInt=null,roundStart=0;
function $(id){return document.getElementById(id)}
function hash(p){var h=0,s=p+"akashic";for(var i=0;i<s.length;i++){h=((h<<5)-h)+s.charCodeAt(i);h&=h}return h.toString(36)}
function getPins(){try{return JSON.parse(localStorage.getItem(PK))||{}}catch(e){return{}}}
function savePins(p){localStorage.setItem(PK,JSON.stringify(p))}
function checkPin(p){return!!getPins()[hash(p)]}
function savePin(p){var pins=getPins();pins[hash(p)]={created:Date.now()};savePins(pins)}
function getUsers(){try{return JSON.parse(localStorage.getItem(UK))||{}}catch(e){return{}}}
function saveUsers(u){localStorage.setItem(UK,JSON.stringify(u))}
function getUser(h){return getUsers()[h]||null}
function saveUser(h,d){var u=getUsers();u[h]=d;saveUsers(u)}
function getDeviceId(){var id=localStorage.getItem(DK);if(!id){id="dev_"+Date.now()+"_"+Math.random().toString(36).substr(2,9);localStorage.setItem(DK,id)}return id}
function getToday(){var d=new Date();return d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()}
function getDeviceTries(){try{var t=JSON.parse(localStorage.getItem("ak_trial_cm"));if(t&&t.startDate)return t}catch(e){}return{n:0,d:getToday(),startDate:getToday()}}
function setDeviceTries(t){localStorage.setItem("ak_trial_cm",JSON.stringify(t))}
function getDaysDiff(s){return Math.floor((new Date()-new Date(s))/864e5)}
function canPlay(){var t=getDeviceTries(),today=getToday(),days=getDaysDiff(t.startDate);if(days>=MAX_DAYS)return{ok:false,left:0,expired:true,daysLeft:0};if(t.d!==today){t.n=0;t.d=today;setDeviceTries(t)}return{ok:t.n<MAX_DAILY,left:MAX_DAILY-t.n,expired:false,daysLeft:MAX_DAYS-days}}
function useTry(){var t=getDeviceTries(),today=getToday();if(t.d!==today){t.n=0;t.d=today}t.n++;setDeviceTries(t);showBanner()}
function getStats(){try{return JSON.parse(localStorage.getItem(SK+hash(currentPin)))||{games:0,bestScore:0,totalScore:0}}catch(e){return{games:0,bestScore:0,totalScore:0}}}
function setStats(s){localStorage.setItem(SK+hash(currentPin),JSON.stringify(s))}
function showBanner(){var c=canPlay();$("bannerEl").textContent=c.expired?"Trial ended":c.left+"/"+MAX_DAILY+" (Day "+c.daysLeft+")"}
function showLimit(){var c=canPlay();$("limitTitle").textContent=c.expired?"Free trial ended":"Daily limit reached";$("limitMsg").textContent=c.expired?"Your 3-day free trial has expired":"You used "+MAX_DAILY+" free games today. "+c.daysLeft+" day(s) remaining.";$("limitPopup").classList.remove("hidden")}
function show(id){["loginBox","createBox","nameBox","dashBox","gameBox"].forEach(function(x){$(x).classList.add("hidden")});$(id).classList.remove("hidden")}
function setDots(pre,n){for(var i=1;i<=4;i++){var el=$(pre+i);if(el){if(i<=n)el.classList.add("on");else el.classList.remove("on")}}}
function setMsg(id,t,isErr){var m=$(id);m.textContent=t;m.className="msg "+(isErr?"err":"ok")}
function getRating(s){if(s>=180)return"Genius";if(s>=140)return"Expert";if(s>=100)return"Great";if(s>=60)return"Good";return"Learning"}
var loginPin="",createPin="",confirmPin="",isConfirming=false;
function buildKeypad(cid,onDigit,onDel){var c=$(cid);c.innerHTML="";for(var i=1;i<=9;i++){(function(d){var b=document.createElement("button");b.className="key";b.textContent=d;b.onclick=function(){onDigit(d)};c.appendChild(b)})(i)}var e=document.createElement("button");e.className="key empty";c.appendChild(e);var z=document.createElement("button");z.className="key";z.textContent="0";z.onclick=function(){onDigit(0)};c.appendChild(z);var del=document.createElement("button");del.className="key";del.textContent="←";del.onclick=onDel;c.appendChild(del)}
function setupLogin(){buildKeypad("loginPad",function(d){if(loginPin.length<4){loginPin+=d;setDots("d",loginPin.length);if(loginPin.length===4){setTimeout(function(){if(checkPin(loginPin)){currentPin=loginPin;currentUser=getUser(hash(currentPin));if(currentUser&&currentUser.name)loadDash();else show("nameBox")}else{setMsg("loginMsg","Incorrect PIN",true);loginPin="";setDots("d",0)}},200)}}},function(){if(loginPin.length>0){loginPin=loginPin.slice(0,-1);setDots("d",loginPin.length);$("loginMsg").textContent=""}})}
function setupCreate(){buildKeypad("createPad",function(d){if(confirmPin.length<4){confirmPin+=d;setDots("c",confirmPin.length);if(confirmPin.length===4){setTimeout(function(){if(!isConfirming){createPin=confirmPin;confirmPin="";isConfirming=true;$("createTitle").textContent="Confirm PIN";$("createSub").textContent="Enter the PIN again";setDots("c",0)}else{if(confirmPin===createPin){savePin(createPin);currentPin=createPin;setMsg("createMsg","PIN created!",false);setTimeout(function(){show("nameBox")},500)}else{setMsg("createMsg","PINs don't match",true);createPin="";confirmPin="";isConfirming=false;$("createTitle").textContent="Create PIN";$("createSub").textContent="Choose a 4-digit PIN";setDots("c",0)}}},200)}}},function(){if(confirmPin.length>0){confirmPin=confirmPin.slice(0,-1);setDots("c",confirmPin.length);$("createMsg").textContent=""}})}
function loadDash(){var s=getStats();$("welcomeName").textContent="Welcome, "+(currentUser?currentUser.name:"Player")+"!";$("dGames").textContent=s.games||0;$("dBest").textContent=s.bestScore||"--";$("dAvg").textContent=s.games>0?Math.round(s.totalScore/s.games):"--";$("dRate").textContent=s.bestScore?getRating(s.bestScore):"--";show("dashBox");showBanner();if(!canPlay().ok)showLimit()}
function shuffle(a){for(var i=a.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var t=a[i];a[i]=a[j];a[j]=t}return a}
function buildColorButtons(){var c=$("colorBtns");c.innerHTML="";var shuffled=shuffle(colors.slice());shuffled.slice(0,4).forEach(function(col){var b=document.createElement("button");b.className="color-btn";b.textContent=col.name;b.style.background=col.hex;b.onclick=function(){checkAnswer(col.name)};c.appendChild(b)})}
function newRound(){if(round>=ROUNDS){endGame();return}var wordColor=colors[Math.floor(Math.random()*colors.length)];var inkColor=colors[Math.floor(Math.random()*colors.length)];$("colorWord").textContent=wordColor.name;$("colorWord").style.color=inkColor.hex;currentAnswer=inkColor.name;var btns=shuffle(colors.slice());while(btns.findIndex(function(c){return c.name===currentAnswer})===-1||btns.length<4){btns=shuffle(colors.slice())}var opts=btns.slice(0,4);if(opts.findIndex(function(c){return c.name===currentAnswer})===-1){opts[Math.floor(Math.random()*4)]=colors.find(function(c){return c.name===currentAnswer})}var c=$("colorBtns");c.innerHTML="";shuffle(opts).forEach(function(col){var b=document.createElement("button");b.className="color-btn";b.textContent=col.name;b.style.background=col.hex;b.onclick=function(){checkAnswer(col.name)};c.appendChild(b)});$("feedback").textContent="";$("feedback").className="feedback";roundStart=Date.now();startTimer()}
function startTimer(){if(timerInt)clearInterval(timerInt);timerInt=setInterval(function(){var elapsed=Date.now()-roundStart;var pct=Math.max(0,100-(elapsed/ROUND_TIME*100));$("timerFill").style.width=pct+"%";if(elapsed>=ROUND_TIME){clearInterval(timerInt);checkAnswer(null)}},50)}
function checkAnswer(ans){if(timerInt)clearInterval(timerInt);round++;$("gRound").textContent=round+"/"+ROUNDS;if(ans===currentAnswer){var timeLeft=Math.max(0,ROUND_TIME-(Date.now()-roundStart));var pts=Math.round(5+timeLeft/100);score+=pts;streak++;if(streak>bestStreak)bestStreak=streak;correct++;$("feedback").textContent="✓ +"+pts;$("feedback").className="feedback correct"}else{streak=0;$("feedback").textContent="✗ Wrong";$("feedback").className="feedback wrong"}$("gScore").textContent=score;$("gStreak").textContent=streak;setTimeout(newRound,800)}
function startGame(){if(!canPlay().ok){showLimit();return}score=0;round=0;correct=0;streak=0;bestStreak=0;show("gameBox");$("gScore").textContent="0";$("gRound").textContent="1/"+ROUNDS;$("gStreak").textContent="0";$("timerFill").style.width="100%";newRound()}
function endGame(){if(timerInt){clearInterval(timerInt);timerInt=null}var s=getStats();s.games++;s.totalScore+=score;var isRec=score>s.bestScore;if(isRec)s.bestScore=score;setStats(s);useTry();$("resScore").textContent=score;$("resCorrect").textContent=correct;$("resStreak").textContent=bestStreak;$("resRating").textContent="Rating: "+getRating(score);if(isRec)$("resRecord").classList.remove("hidden");else $("resRecord").classList.add("hidden");$("resBg").classList.remove("hidden");if(!canPlay().ok)setTimeout(showLimit,1500)}
document.addEventListener("DOMContentLoaded",function(){
getDeviceId();setupLogin();setupCreate();
$("toCreate").onclick=function(){createPin="";confirmPin="";isConfirming=false;$("createTitle").textContent="Create PIN";$("createSub").textContent="Choose a 4-digit PIN";setDots("c",0);$("createMsg").textContent="";show("createBox")};
$("toLogin").onclick=function(){loginPin="";setDots("d",0);$("loginMsg").textContent="";show("loginBox")};
$("saveNameBtn").onclick=function(){var name=$("nameInput").value.trim();if(name.length<2){setMsg("nameMsg","Name too short (min 2)",true);return}if(name.length>15){setMsg("nameMsg","Name too long (max 15)",true);return}currentUser={name:name,created:Date.now()};saveUser(hash(currentPin),currentUser);loadDash()};
$("startBtn").onclick=function(){if(!canPlay().ok){showLimit();return}startGame()};
$("logoutBtn").onclick=function(){loginPin="";currentPin="";currentUser=null;setDots("d",0);show("loginBox")};
$("quitBtn").onclick=function(){if(timerInt){clearInterval(timerInt);timerInt=null}loadDash()};
$("againBtn").onclick=function(){$("resBg").classList.add("hidden");if(!canPlay().ok){showLimit();return}startGame()};
$("menuBtn").onclick=function(){$("resBg").classList.add("hidden");loadDash()};
$("upgradeBtn").onclick=function(){location.href="mailto:support@akashic.works?subject=Pro%20Upgrade"};
show("loginBox");showBanner()
})
})();
</script>
</body>
</html>
