<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Akashic Color Match</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Georgia,serif;background:linear-gradient(135deg,#0a0e27,#1a1034,#2d1b4e);min-height:100vh;color:#e8e8f0;display:flex;flex-direction:column;align-items:center;padding:15px}
.title{font-size:2em;background:linear-gradient(135deg,#ffd700,#ff8c00);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:5px}
.subtitle{color:#d4af37;margin-bottom:20px}
.box{background:rgba(255,255,255,0.05);border:2px solid rgba(212,175,55,0.5);border-radius:18px;padding:22px;width:100%;max-width:420px}
.hidden{display:none!important}
.banner{position:fixed;top:15px;right:15px;background:rgba(255,215,0,0.2);border:2px solid rgba(255,215,0,0.5);color:#ffd700;padding:8px 14px;border-radius:12px;font-size:0.85em}
.back{position:fixed;top:15px;left:15px;padding:8px 14px;background:rgba(255,255,255,0.1);border:2px solid rgba(212,175,55,0.3);border-radius:15px;color:#ffd700;text-decoration:none;font-size:0.85em}
.popup-bg{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);display:flex;justify-content:center;align-items:center;z-index:5000;padding:20px}
.popup{background:linear-gradient(135deg,#1a1034,#2d1b4e);border:2px solid rgba(255,215,0,0.3);border-radius:18px;padding:25px;max-width:300px;text-align:center}
.popup-emoji{font-size:2.5em;margin-bottom:10px}
.popup h3{color:#e8e8f0;margin-bottom:5px}
.popup p{color:#a0a0b8;font-size:0.9em;margin-bottom:20px}
.popup a{display:block;padding:12px;background:rgba(255,255,255,0.08);border:2px solid rgba(255,255,255,0.2);border-radius:10px;color:#e8e8f0;text-decoration:none;margin-bottom:15px}
.popup button{width:100%;background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a1034;border:none;padding:12px;border-radius:20px;font-weight:bold;cursor:pointer;font-family:Georgia,serif}
.pin-title{color:#ffd700;font-size:1.3em;text-align:center;margin-bottom:8px}
.pin-sub{color:#b8b8cc;text-align:center;margin-bottom:20px;font-size:0.9em}
.dots{display:flex;justify-content:center;gap:12px;margin-bottom:20px}
.dot{width:16px;height:16px;border-radius:50%;border:2px solid rgba(212,175,55,0.5)}
.dot.on{background:#ffd700;border-color:#ffd700}
.keypad{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;max-width:220px;margin:0 auto 15px}
.key{aspect-ratio:1;font-size:1.4em;border:2px solid rgba(212,175,55,0.3);background:rgba(255,255,255,0.05);color:#e8e8f0;border-radius:10px;cursor:pointer;font-family:Georgia,serif}
.key:active{transform:scale(0.95)}
.key.empty{visibility:hidden}
.msg{text-align:center;min-height:20px;font-size:0.9em}
.msg.err{color:#ff6b6b}
.msg.ok{color:#4ecdc4}
.toggle{text-align:center;margin-top:18px;color:#b8b8cc;font-size:0.9em}
.toggle span{color:#ffd700;cursor:pointer;text-decoration:underline}
.btn{width:100%;background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a1034;border:none;padding:14px;border-radius:22px;font-size:1em;font-weight:bold;cursor:pointer;margin-top:8px;font-family:Georgia,serif}
.btn:hover{box-shadow:0 5px 20px rgba(255,215,0,0.5)}
.btn2{background:linear-gradient(135deg,#8a2be2,#4b0082);color:#fff}
.welcome{background:rgba(255,215,0,0.1);border:2px solid rgba(255,215,0,0.3);border-radius:12px;padding:15px;margin-bottom:15px;text-align:center}
.welcome h3{color:#ffd700;margin-bottom:5px}
.stats{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin:15px 0}
.stat{background:rgba(255,255,255,0.05);padding:12px;border-radius:10px;text-align:center;border:1px solid rgba(212,175,55,0.2)}
.stat b{display:block;font-size:1.5em;color:#ffd700}
.stat span{color:#b8b8cc;font-size:0.75em}
.mode-select{margin:15px 0}
.mode-select label{color:#b8b8cc;display:block;margin-bottom:8px;text-align:center;font-size:0.9em}
.mode-btns{display:flex;gap:8px;justify-content:center}
.mode-btn{padding:10px 16px;border:2px solid rgba(212,175,55,0.3);background:rgba(255,255,255,0.05);color:#e8e8f0;border-radius:10px;cursor:pointer;font-size:0.9em;font-family:Georgia,serif}
.mode-btn.sel{background:rgba(255,215,0,0.2);border-color:#ffd700;color:#ffd700}
.hdr{display:flex;justify-content:space-between;padding:10px;background:rgba(255,255,255,0.05);border-radius:10px;margin-bottom:12px}
.hdr div{text-align:center}
.hdr b{color:#ffd700;font-size:1.2em}
.hdr span{color:#b8b8cc;font-size:0.65em;display:block}
.timer-bar{width:100%;height:8px;background:rgba(255,255,255,0.1);border-radius:4px;margin-bottom:15px;overflow:hidden}
.timer-fill{height:100%;background:linear-gradient(90deg,#e74c3c,#f1c40f,#2ecc71);border-radius:4px;transition:width 0.05s linear}
.color-display{background:rgba(0,0,0,0.4);border-radius:15px;padding:30px 20px;margin-bottom:15px;text-align:center;border:2px solid rgba(212,175,55,0.3)}
.color-word{font-size:3em;font-weight:bold;text-transform:uppercase;margin-bottom:5px}
.color-instruction{color:#b8b8cc;font-size:0.95em;margin-bottom:10px}
.answer-btns{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:12px}
.answer-btn{padding:18px;font-size:1.1em;font-weight:bold;border:3px solid;background:rgba(0,0,0,0.3);border-radius:12px;cursor:pointer;transition:transform 0.1s;text-transform:uppercase;font-family:Georgia,serif}
.answer-btn:hover{transform:scale(1.03)}
.answer-btn:active{transform:scale(0.97)}
.answer-btn.correct{animation:flashG 0.4s}
.answer-btn.wrong{animation:flashR 0.4s}
@keyframes flashG{0%,100%{background:rgba(0,0,0,0.3)}50%{background:rgba(46,204,113,0.6)}}
@keyframes flashR{0%,100%{background:rgba(0,0,0,0.3)}50%{background:rgba(231,76,60,0.6)}}
.fb{text-align:center;min-height:24px;margin-bottom:10px;font-size:1em}
.fb.g{color:#2ecc71}
.fb.r{color:#e74c3c}
.fb.n{color:#b8b8cc}
.info{background:rgba(138,43,226,0.15);border:2px solid rgba(138,43,226,0.3);border-radius:10px;padding:10px;margin-top:10px}
.info h4{color:#8a2be2;margin-bottom:5px;text-align:center;font-size:0.85em}
.info p{color:#c4c4d4;font-size:0.78em;line-height:1.4;text-align:center}
.res-bg{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.9);display:flex;justify-content:center;align-items:center;z-index:3000;padding:20px}
.res{background:linear-gradient(135deg,#1a1034,#2d1b4e);border:3px solid #ffd700;border-radius:20px;padding:25px 20px;max-width:350px;width:100%;text-align:center;animation:zoomIn 0.3s}
@keyframes zoomIn{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}
.res-icon{font-size:3em;margin-bottom:10px}
.res h2{color:#ffd700;margin-bottom:10px;font-size:1.4em}
.res-score{font-size:3em;color:#ffd700;font-weight:bold}
.res-label{color:#b8b8cc;margin-bottom:15px}
.res-stats{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-bottom:15px}
.res-stat{background:rgba(255,255,255,0.05);padding:10px;border-radius:8px}
.res-stat b{color:#ffd700;font-size:1.3em;display:block}
.res-stat span{color:#b8b8cc;font-size:0.7em}
.record{background:rgba(255,215,0,0.2);border:2px solid #ffd700;border-radius:8px;padding:10px;margin:12px 0;color:#ffd700;font-weight:bold}
.rating{color:#d4af37;margin-bottom:15px}
@media(max-width:500px){.back,.banner{position:relative;top:auto;left:auto;right:auto;margin:0 5px 10px;display:inline-block}.color-word{font-size:2.4em}.answer-btn{padding:15px;font-size:1em}}
</style>
</head>
<body>
<a href="https://hooporiapr-oss.github.io/akashic-works/" class="back">‚Üê Home</a>
<div class="title">üé® Color Match</div>
<div class="subtitle">Stroop Test Challenge</div>

<div class="box" id="loginBox">
<div class="pin-title">Enter PIN</div>
<div class="pin-sub">Enter your 4-digit PIN</div>
<div class="dots"><div class="dot" id="d1"></div><div class="dot" id="d2"></div><div class="dot" id="d3"></div><div class="dot" id="d4"></div></div>
<div class="keypad" id="loginPad"></div>
<div class="msg" id="loginMsg"></div>
<div class="toggle">No account? <span id="toCreate">Create PIN</span></div>
</div>

<div class="box hidden" id="createBox">
<div class="pin-title" id="createTitle">Create PIN</div>
<div class="pin-sub" id="createSub">Choose a 4-digit PIN</div>
<div class="dots"><div class="dot" id="c1"></div><div class="dot" id="c2"></div><div class="dot" id="c3"></div><div class="dot" id="c4"></div></div>
<div class="keypad" id="createPad"></div>
<div class="msg" id="createMsg"></div>
<div class="toggle">Have a PIN? <span id="toLogin">Login</span></div>
</div>

<div class="box hidden" id="dashBox">
<div class="welcome"><h3>Welcome Back! üé®</h3><p style="color:#b8b8cc">Test your brain with colors</p></div>
<div class="stats">
<div class="stat"><b id="dGames">0</b><span>Games</span></div>
<div class="stat"><b id="dBest">--</b><span>Best Score</span></div>
<div class="stat"><b id="dAvg">--</b><span>Avg Score</span></div>
<div class="stat"><b id="dRate">--</b><span>Rating</span></div>
</div>
<div class="mode-select">
<label>Game Mode</label>
<div class="mode-btns">
<button class="mode-btn sel" data-mode="color">Text Color</button>
<button class="mode-btn" data-mode="word">Word Meaning</button>
</div>
</div>
<button class="btn" id="startBtn">üé® Start Game</button>
<button class="btn btn2" id="logoutBtn">Logout</button>
</div>

<div class="box hidden" id="gameBox">
<div class="hdr">
<div><b id="gScore">0</b><span>SCORE</span></div>
<div><b id="gRound">1/20</b><span>ROUND</span></div>
<div><b id="gStreak">0</b><span>STREAK</span></div>
</div>
<div class="timer-bar"><div class="timer-fill" id="timerFill"></div></div>
<div class="color-display">
<div class="color-instruction" id="instruction">What COLOR is the text?</div>
<div class="color-word" id="colorWord">RED</div>
</div>
<div class="answer-btns" id="answerBtns"></div>
<div class="fb n" id="fb">Choose quickly!</div>
<button class="btn btn2" id="quitBtn">‚Üê Quit</button>
<div class="info">
<h4>How to Play</h4>
<p id="instrText">Select the COLOR the text is displayed in, not what the word says!</p>
</div>
</div>

<div class="res-bg hidden" id="resBg">
<div class="res">
<div class="res-icon" id="resIcon">üé®</div>
<h2>Game Complete!</h2>
<div class="res-score" id="resScore">0</div>
<div class="res-label">Score</div>
<div class="res-stats">
<div class="res-stat"><b id="resCorrect">0</b><span>Correct</span></div>
<div class="res-stat"><b id="resWrong">0</b><span>Wrong</span></div>
<div class="res-stat"><b id="resAcc">0%</b><span>Accuracy</span></div>
<div class="res-stat"><b id="resStreak">0</b><span>Best Streak</span></div>
</div>
<div class="record hidden" id="resRecord">üèÜ New Record!</div>
<div class="rating" id="resRating">Rating: --</div>
<button class="btn" id="againBtn">üîÑ Play Again</button>
<button class="btn btn2" id="menuBtn">Menu</button>
</div>
</div>

<div class="popup-bg hidden" id="limitPopup">
<div class="popup">
<div class="popup-emoji">‚è∏Ô∏è</div>
<h3>Daily limit reached</h3>
<p>You've used 3 free plays today</p>
<a href="https://hooporiapr-oss.github.io/akashic-works/">Return Home</a>
<button id="upgradeBtn">Unlock Unlimited</button>
</div>
</div>

<script>
(function(){
var PK="cm_pin",SK="cm_stats",TK="cm_tries",MAX=3,ROUNDS=20,TIME=3000;
var COLORS=[
{name:"RED",hex:"#e74c3c"},
{name:"BLUE",hex:"#3498db"},
{name:"GREEN",hex:"#2ecc71"},
{name:"YELLOW",hex:"#f1c40f"},
{name:"PURPLE",hex:"#9b59b6"},
{name:"ORANGE",hex:"#e67e22"}
];
function hash(p){var h=0,s=p+"cm24";for(var i=0;i<s.length;i++){h=((h<<5)-h)+s.charCodeAt(i);h&=h;}return h.toString(36);}
function hasPin(){return!!localStorage.getItem(PK);}
function checkPin(p){return localStorage.getItem(PK)===hash(p);}
function savePin(p){localStorage.setItem(PK,hash(p));localStorage.setItem(SK,JSON.stringify({games:0,best:0,total:0}));}
function getStats(){try{return JSON.parse(localStorage.getItem(SK))||{games:0,best:0,total:0};}catch(e){return{games:0,best:0,total:0};}}
function setStats(s){localStorage.setItem(SK,JSON.stringify(s));}
function getTries(){try{var t=JSON.parse(localStorage.getItem(TK));if(t&&t.d)return t;}catch(e){}return{n:0,d:new Date().toDateString()};}
function setTries(t){localStorage.setItem(TK,JSON.stringify(t));}
function canPlay(){var t=getTries();if(t.d!==new Date().toDateString()){t.n=0;t.d=new Date().toDateString();setTries(t);}return{ok:t.n<MAX,left:MAX-t.n};}
function useTry(){var t=getTries();if(t.d!==new Date().toDateString()){t.n=0;t.d=new Date().toDateString();}t.n++;setTries(t);showBanner();}
function showBanner(){var c=canPlay(),old=document.querySelector(".banner");if(old)old.remove();var b=document.createElement("div");b.className="banner";b.textContent="üéÆ "+c.left+" free "+(c.left===1?"try":"tries");document.body.appendChild(b);}
function showLimit(){document.getElementById("limitPopup").classList.remove("hidden");}
function show(id){["loginBox","createBox","dashBox","gameBox"].forEach(function(x){document.getElementById(x).classList.add("hidden");});document.getElementById(id).classList.remove("hidden");}
function dots(pre,n){for(var i=1;i<=4;i++){var el=document.getElementById(pre+i);if(el)el.classList.toggle("on",i<=n);}}
function msg(id,t,e){var m=document.getElementById(id);m.textContent=t;m.className="msg "+(e?"err":"ok");}
function getRating(s){if(!s)return"--";if(s>=18)return"üß† Genius";if(s>=15)return"‚≠ê Master";if(s>=12)return"üî• Expert";if(s>=8)return"üëç Good";return"üìö Learning";}
function shuffle(a){for(var i=a.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var t=a[i];a[i]=a[j];a[j]=t;}return a;}

var loginPin="",createPin="",confirmPin="",confirming=false,gameMode="color";
var score=0,round=0,correct=0,wrong=0,streak=0,bestStreak=0,answer="",timer=null,timeLeft=0,playing=false;

function buildPad(id,onNum,onDel){
var pad=document.getElementById(id);pad.innerHTML="";
for(var i=1;i<=9;i++){(function(n){var k=document.createElement("button");k.className="key";k.textContent=n;k.onclick=function(){onNum(n);};pad.appendChild(k);})(i);}
var empty=document.createElement("button");empty.className="key empty";pad.appendChild(empty);
var zero=document.createElement("button");zero.className="key";zero.textContent="0";zero.onclick=function(){onNum(0);};pad.appendChild(zero);
var del=document.createElement("button");del.className="key";del.textContent="‚å´";del.onclick=onDel;pad.appendChild(del);
}

function initLogin(){
buildPad("loginPad",function(n){
if(loginPin.length<4){loginPin+=n;dots("d",loginPin.length);
if(loginPin.length===4){setTimeout(function(){if(checkPin(loginPin)){loadDash();}else{msg("loginMsg","Wrong PIN",true);loginPin="";dots("d",0);}},200);}}
},function(){if(loginPin.length>0){loginPin=loginPin.slice(0,-1);dots("d",loginPin.length);document.getElementById("loginMsg").textContent="";}});
}

function initCreate(){
buildPad("createPad",function(n){
if(confirmPin.length<4){confirmPin+=n;dots("c",confirmPin.length);
if(confirmPin.length===4){setTimeout(function(){
if(!confirming){createPin=confirmPin;confirmPin="";confirming=true;document.getElementById("createTitle").textContent="Confirm PIN";document.getElementById("createSub").textContent="Enter PIN again";dots("c",0);}
else{if(confirmPin===createPin){savePin(createPin);msg("createMsg","PIN created!",false);setTimeout(loadDash,500);}else{msg("createMsg","PINs don't match",true);createPin="";confirmPin="";confirming=false;document.getElementById("createTitle").textContent="Create PIN";document.getElementById("createSub").textContent="Choose a 4-digit PIN";dots("c",0);}}
},200);}}
},function(){if(confirmPin.length>0){confirmPin=confirmPin.slice(0,-1);dots("c",confirmPin.length);document.getElementById("createMsg").textContent="";}});
}

function loadDash(){
var s=getStats();
document.getElementById("dGames").textContent=s.games||0;
document.getElementById("dBest").textContent=s.best||"--";
document.getElementById("dAvg").textContent=s.games>0?Math.round(s.total/s.games):"--";
document.getElementById("dRate").textContent=getRating(s.best);
show("dashBox");showBanner();
if(!canPlay().ok)showLimit();
}

function startGame(){
if(!canPlay().ok){showLimit();return;}
score=0;round=0;correct=0;wrong=0;streak=0;bestStreak=0;playing=true;
document.getElementById("resBg").classList.add("hidden");
if(gameMode==="color"){
document.getElementById("instruction").textContent="What COLOR is the text?";
document.getElementById("instrText").textContent="Select the COLOR the text is displayed in, not what the word says!";
}else{
document.getElementById("instruction").textContent="What does the WORD say?";
document.getElementById("instrText").textContent="Select what the WORD says, ignore the color!";
}
show("gameBox");
nextRound();
}

function nextRound(){
if(!playing)return;
round++;
if(round>ROUNDS){endGame();return;}
document.getElementById("gScore").textContent=score;
document.getElementById("gRound").textContent=round+"/"+ROUNDS;
document.getElementById("gStreak").textContent=streak;
document.getElementById("fb").textContent="Choose quickly!";
document.getElementById("fb").className="fb n";

var wordC=COLORS[Math.floor(Math.random()*COLORS.length)];
var textC=COLORS[Math.floor(Math.random()*COLORS.length)];
var wordEl=document.getElementById("colorWord");
wordEl.textContent=wordC.name;
wordEl.style.color=textC.hex;
answer=gameMode==="color"?textC.name:wordC.name;

var opts=[answer];
while(opts.length<4){var c=COLORS[Math.floor(Math.random()*COLORS.length)].name;if(opts.indexOf(c)===-1)opts.push(c);}
shuffle(opts);

var btns=document.getElementById("answerBtns");
btns.innerHTML="";
opts.forEach(function(opt){
var b=document.createElement("button");
b.className="answer-btn";
b.textContent=opt;
var col=COLORS.find(function(x){return x.name===opt;});
b.style.color=col.hex;
b.style.borderColor=col.hex;
b.onclick=function(){pick(opt,b);};
btns.appendChild(b);
});

timeLeft=TIME;
document.getElementById("timerFill").style.width="100%";
clearInterval(timer);
timer=setInterval(function(){
timeLeft-=50;
document.getElementById("timerFill").style.width=(timeLeft/TIME*100)+"%";
if(timeLeft<=0){clearInterval(timer);timeout();}
},50);
}

function pick(opt,btn){
if(!playing)return;
clearInterval(timer);
var btns=document.querySelectorAll(".answer-btn");
btns.forEach(function(b){b.onclick=null;});
if(opt===answer){
correct++;score++;streak++;
if(streak>bestStreak)bestStreak=streak;
btn.classList.add("correct");
document.getElementById("fb").textContent="‚úì Correct!";
document.getElementById("fb").className="fb g";
}else{
wrong++;streak=0;
btn.classList.add("wrong");
document.getElementById("fb").textContent="‚úó Wrong! It was "+answer;
document.getElementById("fb").className="fb r";
}
setTimeout(nextRound,600);
}

function timeout(){
wrong++;streak=0;
document.getElementById("fb").textContent="‚è±Ô∏è Too slow! It was "+answer;
document.getElementById("fb").className="fb r";
setTimeout(nextRound,600);
}

function endGame(){
playing=false;clearInterval(timer);
var s=getStats();
s.games++;
s.total+=score;
var rec=score>s.best;
if(rec)s.best=score;
setStats(s);
useTry();
var acc=(correct+wrong)>0?Math.round(correct/(correct+wrong)*100):0;
document.getElementById("resScore").textContent=score;
document.getElementById("resCorrect").textContent=correct;
document.getElementById("resWrong").textContent=wrong;
document.getElementById("resAcc").textContent=acc+"%";
document.getElementById("resStreak").textContent=bestStreak;
document.getElementById("resRating").textContent="Rating: "+getRating(score);
document.getElementById("resRecord").classList.toggle("hidden",!rec);
document.getElementById("resIcon").textContent=score>=15?"üèÜ":score>=10?"‚≠ê":"üé®";
document.getElementById("resBg").classList.remove("hidden");
if(!canPlay().ok)setTimeout(showLimit,1500);
}

document.addEventListener("DOMContentLoaded",function(){
initLogin();initCreate();
document.getElementById("toCreate").onclick=function(){createPin="";confirmPin="";confirming=false;document.getElementById("createTitle").textContent="Create PIN";document.getElementById("createSub").textContent="Choose a 4-digit PIN";dots("c",0);document.getElementById("createMsg").textContent="";show("createBox");};
document.getElementById("toLogin").onclick=function(){loginPin="";dots("d",0);document.getElementById("loginMsg").textContent="";show("loginBox");};
document.querySelectorAll(".mode-btn").forEach(function(btn){
btn.onclick=function(){document.querySelectorAll(".mode-btn").forEach(function(b){b.classList.remove("sel");});btn.classList.add("sel");gameMode=btn.dataset.mode;};
});
document.getElementById("startBtn").onclick=function(){if(!canPlay().ok){showLimit();return;}startGame();};
document.getElementById("logoutBtn").onclick=function(){loginPin="";dots("d",0);show("loginBox");};
document.getElementById("quitBtn").onclick=function(){playing=false;clearInterval(timer);loadDash();};
document.getElementById("againBtn").onclick=function(){if(!canPlay().ok){document.getElementById("resBg").classList.add("hidden");showLimit();return;}startGame();};
document.getElementById("menuBtn").onclick=function(){document.getElementById("resBg").classList.add("hidden");loadDash();};
document.getElementById("upgradeBtn").onclick=function(){location.href="mailto:support@akashic.works?subject=Pro%20Upgrade";};
if(hasPin())show("loginBox");else show("createBox");
});
})();
</script>
</body>
</html>
